- 可见性

  - 会从主内存中读取变量，并将其缓存到线程的工作内存中。
  - 但是并不能安全写回主内存（`volatile` 变量只能保证可见性，不能保证原子性）。

- 禁止指令重排序

  - 底层基于操作系统的内存屏障指令，禁止 CPU 和编译器对指令进行优化重排序。
  - Unsafe 类中提供 `native` 方法，可以实现内存屏障指令。

    - `final` 关键字修饰变量时，拥有**读写屏障**能力，这也是为什么多线程内使用外部的变量需要使用 `final` 修饰的根因。
    - 当一个线程写入 `final` 修饰的变量时会插入写屏障，会保证**其他线程**读取到的是初始化后的变量。
    - 当一个线程读取 `final` 修饰的变量时会插入读屏障，会保证读取到的是初始化后的变量。

    ```java
    Unsafe.getUnsafe().storeFence();
    Unsafe.getUnsafe().loadFence();
    Unsafe.getUnsafe().fullFence();
    ```
